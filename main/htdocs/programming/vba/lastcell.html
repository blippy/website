<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html><head>
	<meta http-equiv="CONTENT-TYPE" content="text/html; charset=iso-8859-1">
	
	<title>Lastcell</title><meta name="AUTHOR" content="Mark"></head>

<body bgcolor="#ffffff">

<a href="../../index.html">Home</a> : 
<a href="../programming.htm">programming</a>  :
<a href="vba.htm">vba</a>

<p>Finding the real last cell in a spreadhseet.</p>
<h2>Method 1 (unreliable)</h2>
<p>The standard method for determining the last row/column in an Excel spreadsheet 
  is: </p>

<blockquote>
  <pre>num_rows = ws.Range("A1").SpecialCells(xlLastCell).Row<br></pre>
</blockquote>
<p>Unfortunately, the result obtained is often wrong. Excel remembers the highest 
  row/column used for a worksheet; but it does not reset it to a lower value if 
  the extreme cells are emptied. To overcome this problem, you must adopt the 
  method below</p>
<h2>Method 2 (reliable)</h2>
<pre>
Public Function NumRows(ws)
'return the number of rows in a worksheet

    NumRows = 0
    On Error Resume Next
    NumRows = ws.Cells.Find("*", ws.Range("A1"), _
        xlFormulas, , xlByRows, xlPrevious).Row
   On Error GoTo 0
End Function

Public Function NumCols(ws)
'return the number of columns in a worksheet

    NumCols = 0
    On Error Resume Next
    NumCols = ws.Cells.Find("*", ws.Range("A1"), _
        xlFormulas, , xlByColumns, xlPrevious).Column
   On Error GoTo 0
   
End Function


 </pre>
<hr>
  <small>Date: 17-Dec-2003</small><br><h2>&nbsp; </h2>
</body></html>
