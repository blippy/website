<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html><head>
<meta http-equiv="CONTENT-TYPE" content="text/html; charset=iso-8859-1"><title>Keypress</title>

<meta name="AUTHOR" content="Mark">
</head>

<body style="background-color: rgb(255, 255, 255);">

<a href="../../index.html">Home</a> : 
<a href="../programming.htm">programming</a>  :
<a href="vba.htm">vba</a>


<p>This page is about trapping, allowing, disallowing, and
modifying key presses in VB(A), especially with respect to text boxes.</p>
<p>The easiest way to do this is by example. Suppose you have a
textbox called Text1. The example code that I've given below traps the
keys to the textbox so that only alphabetic (a-z, A-Z) and numeric
(0-9) keys can be entered. Moreover, lower case letters are converted
to upper case letters. I have also enabled the Delete key - which is,
after all, quite a useful key. Here's the code:</p>
<p>&nbsp;</p>
<pre>Private Sub Text1_KeyPress(KeyAscii As Integer)<br><br> Select Case KeyAscii<br> Case 8: 'allow delete key<br> Case Asc("a") To Asc("z"): KeyAscii = KeyAscii + Asc("A") - Asc("a") 'convert lower to upper<br> Case Asc("A") To Asc("Z"), Asc("0") To Asc("9"): 'OK, don't alter the key<br> Case Else: KeyAscii = 0 'disallow everything else<br> End Select<br>End Sub</pre>
<p>&nbsp;</p>
<hr>
<p><small>Created: 14-Oct-2004</small>&nbsp; </p>
</body></html>
