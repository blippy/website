' how to create a toolbar' 1.3 04-Feb-2003 Mark Carter'Also refer to Excel 2000 VBA page 210''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Private Sub Workbook_Open() 'standard function in ThisWorkbook    Call CreateToolBar 'a function you create - see belowEnd Sub''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Private Sub Workbook_BeforeClose(Cancel As Boolean)    Application.CommandBars("MyToolbar").DeleteEnd Sub''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Public Sub CreateToolBar() 'you can define this in a separate module        'remove any existing toolbar    On Error Resume Next    CommandBars("MyToolbar").Delete    On Error GoTo 0        'create new toolbar    With CommandBars.Add(name:="MyToolbar") 'MyToolbar will appear as the toolbar's caption                'add a dropdown menu        With .Controls.Add(Type:=msoControlDropdown)            .AddItem "Item 1"            .AddItem "Item 2"            .AddItem "Item 3"            .TooltipText = "Descriptive text here"            .ListIndex = 1            viewContents = .List(.ListIndex)            .OnAction = "DoSomething" 'you must define the macro DoSomething()        End With        'add "Do Something" button        With .Controls.Add(Type:=msoControlButton)            .FaceId = 2553            .OnAction = "DoSomething1" 'you must define the macro DoSomething1()            .TooltipText = "Descriptive text here"            .Tag = "MyToolbar.DoSomething" ' (optional). If used, give meaningful name for subsequent manipulation         End With                ' more buttons and other items    .Position =msoBarTop 'docks it to iconbar    .Visible = True    End WithEnd Sub''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' how to subsequently manipulate (e.g. enable/disable) a toolbar icon    Dim ctrl As CommandBarButton    Set ctrl = Application.CommandBars.FindControl(Tag:="MyToolbar.DoSomething")    ctrl.Enabled = False